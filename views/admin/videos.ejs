<!DOCTYPE html>
<html lang="en">
<head>
  <%- include('../partials/head.ejs', { pageTitle: 'Admin · Videos', pageDescription: 'Manage Watch videos' }) %>
</head>
<body>
  <%- include('../partials/navbar') %>

  <main class="container stack" style="--gap:24px">
    <a class="back" href="/" onclick="if(document.referrer){history.back();return false;}">← Back</a>
    <h1>Admin · Videos</h1>

    <div class="card">
      <h3 style="margin-top:0">Add a video</h3>
      <form method="post" action="/admin/videos/create" class="stack" style="--gap:8px">
        <input class="input" type="text" name="title" placeholder="Title" required>
        <input class="input" type="url" name="href" placeholder="Video URL (YouTube/Vimeo/etc.)" required>
        <input class="input" type="url" name="thumbnail" placeholder="Thumbnail URL (optional)">
        <button class="btn" type="submit">Add</button>
      </form>
    </div>

    <div class="grid cols-4">
      <% if (rows && rows.length) { %>
        <% rows.forEach(v => { %>
          <div class="card hover">
            <div style="position:relative">
              <% if (v.thumbnail) { %>
                <img class="cover-img" src="<%= v.thumbnail %>" alt="">
              <% } else { %>
                <div class="cover-ph">VID</div>
              <% } %>
            </div>
            <div style="margin-top:10px">
              <div class="book-title"><%= v.title %></div>
              <div class="muted" style="font-size:12px;word-break:break-all"><%= v.href %></div>
            </div>
            <form method="post" action="/admin/videos/<%= v._id %>/delete" style="margin-top:10px">
              <button class="btn secondary" type="submit" onclick="return confirm('Delete this video?')">Delete</button>
              <a class="btn" style="margin-left:8px" href="<%= v.href %>" target="_blank" rel="noopener">Open</a>
            </form>
          </div>
        <% }) %>
      <% } else { %>
        <div class="card">No videos yet.</div>
      <% } %>
    </div>
  </main>

  <%- include('../partials/footer') %>
