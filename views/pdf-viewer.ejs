<!DOCTYPE html>
<html lang="en">
<head>
  <%- include('./partials/head.ejs', {
    pageTitle: (typeof pageTitle !== 'undefined' && pageTitle) ? pageTitle : 'PDF Viewer',
    pageDescription: 'Read PDFs inline with a simple viewer.'
  }) %>
  <style>
    body{margin:0;background:#0b1220}
    .topbar{
      position:sticky;top:0;z-index:10;display:flex;gap:.5rem;align-items:center;
      padding:.5rem .75rem;background:rgba(15,23,42,.85);backdrop-filter:blur(8px);
      color:#e5e7eb;border-bottom:1px solid rgba(255,255,255,.08)
    }
    .topbar .title{font-weight:700;margin-left:.25rem;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    .spacer{flex:1}
    .btn{border:1px solid rgba(255,255,255,.18);background:#111827;color:#fff;padding:.45rem .75rem;border-radius:.6rem;text-decoration:none;font-weight:700}
    .viewer{height:calc(100vh - 56px)}
    .viewer iframe{width:100%;height:100%;border:0;background:#1f2937}
    .fallback{padding:1rem;color:#e5e7eb}
  </style>
</head>
<body>
  <%- include('./partials/navbar.ejs') %>

  <% 
    const src   = (typeof pdfUrl !== 'undefined' && pdfUrl) ? pdfUrl : (typeof query !== 'undefined' && query.src ? query.src : '');
    const title = (typeof pageTitle !== 'undefined' && pageTitle) ? pageTitle : (typeof query !== 'undefined' && query.title ? query.title : 'PDF');
  %>

  <div class="topbar">
    <a class="btn" href="javascript:history.back()">← Back</a>
    <div class="title"><%= title %></div>
    <div class="spacer"></div>
    <% if (src) { %>
      <a class="btn" href="<%= src %>" target="_blank" rel="noopener">Open externally ↗</a>
    <% } %>
  </div>

  <div class="viewer">
    <% if (src) { %>
      <!-- Many hosts allow native PDF viewing; if blocked by X-Frame-Options, the “Open externally” button above remains. -->
      <iframe src="<%= src %>#view=FitH" title="PDF"></iframe>
    <% } else { %>
      <div class="fallback">No PDF provided.</div>
    <% } %>
  </div>
</body>
</html>
