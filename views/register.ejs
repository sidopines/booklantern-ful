<!DOCTYPE html>
<html lang="en">
<head>
  <%- include('./partials/head.ejs', {
    pageTitle: 'Create Account - BookLantern',
    pageDescription: 'Join BookLantern to track your reading progress and save your favorite books.'
  }) %>
</head>
<body data-page="auth">
  <%- include('./partials/navbar.ejs') %>

  <main class="content-section">
    <div class="container">
      <%- include('./partials/backLink.ejs', { text: 'Back', fallback: '/' }) %>
      
      <div class="auth-card">
        <div class="auth-header">
          <h1 class="auth-title">Create your account</h1>
          <p class="auth-subtitle">Join BookLantern to unlock your reading journey</p>
        </div>

        <% if (typeof error !== 'undefined' && error) { %>
          <div class="alert error"><%= error %></div>
        <% } %>
        <% if (typeof message !== 'undefined' && message) { %>
          <div class="alert success"><%= message %></div>
        <% } %>

        <form action="/register" method="POST" class="auth-form">
          <!-- carry next destination -->
          <input type="hidden" name="next" value="<%= typeof next !== 'undefined' ? next : '' %>">

          <div class="form-group">
            <label for="name" class="form-label">Full name</label>
            <input
              type="text"
              id="name"
              name="name"
              class="form-input"
              value="<%= typeof formData !== 'undefined' && formData.name ? formData.name : '' %>"
              required
              autocomplete="name"
              placeholder="Enter your full name"
            />
          </div>

          <div class="form-group">
            <label for="email" class="form-label">Email address</label>
            <input
              type="email"
              id="email"
              name="email"
              class="form-input"
              value="<%= typeof formData !== 'undefined' && formData.email ? formData.email : '' %>"
              required
              autocomplete="email"
              placeholder="your@email.com"
            />
          </div>

          <div class="form-group">
            <label for="password" class="form-label">Password</label>
            <input
              type="password"
              id="password"
              name="password"
              class="form-input"
              required
              autocomplete="new-password"
              placeholder="Create a secure password"
              minlength="8"
            />
            <small style="color: var(--ink-weak); font-size: 12px; margin-top: 4px; display: block;">
              At least 8 characters
            </small>
          </div>

          <div class="form-group">
            <label for="confirmPassword" class="form-label">Confirm password</label>
            <input
              type="password"
              id="confirmPassword"
              name="confirmPassword"
              class="form-input"
              required
              autocomplete="new-password"
              placeholder="Confirm your password"
            />
          </div>

          <button type="submit" class="btn">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path>
              <circle cx="9" cy="7" r="4"></circle>
              <path d="M22 21v-2a4 4 0 0 0-3-3.87"></path>
              <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
            </svg>
            Create Account
          </button>
        </form>

        <div class="auth-links">
          <p>Already have an account? <a href="/login<%= next ? ('?next=' + encodeURIComponent(next)) : '' %>">Sign in here</a></p>
        </div>
      </div>
    </div>
  </main>

  <%- include('./partials/footer.ejs') %>
</body>
</html>

<style>
/* Register page specific styles */
.auth-form .btn {
  width: 100%;
  gap: 8px;
  margin-top: 8px;
}

.auth-links a {
  color: var(--brand);
  text-decoration: none;
  font-weight: 500;
}

.auth-links a:hover {
  text-decoration: underline;
}

.auth-links p {
  margin: 0;
}

/* Password validation styling */
.form-input:invalid {
  border-color: #dc2626;
}

.form-input:valid {
  border-color: #16a34a;
}

/* Focus states */
.form-input:focus:invalid {
  border-color: var(--brand);
  box-shadow: 0 0 0 3px var(--ring);
}
</style>

<script>
// Password confirmation validation
document.addEventListener('DOMContentLoaded', function() {
  const password = document.getElementById('password');
  const confirmPassword = document.getElementById('confirmPassword');
  
  function validatePassword() {
    if (password.value !== confirmPassword.value) {
      confirmPassword.setCustomValidity('Passwords do not match');
    } else {
      confirmPassword.setCustomValidity('');
    }
  }
  
  password.addEventListener('input', validatePassword);
  confirmPassword.addEventListener('input', validatePassword);
});
</script>