<%
const msgs = (typeof messages !== 'undefined') ? messages : {};
const next = (typeof nextUrl !== 'undefined') ? nextUrl : '';
const error = (typeof registerError !== 'undefined') ? registerError : '';
const csrfToken = (typeof _csrf !== 'undefined') ? _csrf : '';
%>
<!DOCTYPE html>
<html lang="en">
<head>
  <%- include('./partials/head') %>
</head>
<body>
  <%- include('./partials/navbar') %>

  <div class="container" style="padding-top:16px">
    <%- include('./partials/backLink') %>
  </div>

  <main class="container" style="padding:40px 0;max-width:420px">
    <div class="card" style="padding:32px">
      <div class="stack" style="--gap:24px">
        <div class="stack" style="--gap:8px;text-align:center">
          <h1>Create Account</h1>
          <p class="muted">Join BookLantern to unlock your reading journey</p>
        </div>

        <% if (error) { %>
          <div style="background:var(--rose);color:#fff;padding:12px;border-radius:8px;font-size:14px"><%= error %></div>
        <% } %>
        <% if (msgs.error) { %>
          <div style="background:var(--rose);color:#fff;padding:12px;border-radius:8px;font-size:14px"><%= msgs.error %></div>
        <% } %>
        <% if (msgs.success) { %>
          <div style="background:var(--green);color:#fff;padding:12px;border-radius:8px;font-size:14px"><%= msgs.success %></div>
        <% } %>

        <form class="stack" style="--gap:16px" action="/auth/register" method="post">
          <% if (csrfToken) { %><input type="hidden" name="_csrf" value="<%= csrfToken %>"><% } %>
          <% if (next) { %><input type="hidden" name="next" value="<%= next %>"><% } %>
          
          <div class="stack" style="--gap:6px">
            <label for="name">Full Name</label>
            <input class="input" type="text" name="name" id="name" required>
          </div>
          
          <div class="stack" style="--gap:6px">
            <label for="email">Email</label>
            <input class="input" type="email" name="email" id="email" required>
          </div>
          
          <div class="stack" style="--gap:6px">
            <label for="password">Password</label>
            <input class="input" type="password" name="password" id="password" required>
          </div>
          
          <div class="stack" style="--gap:6px">
            <label for="confirmPassword">Confirm Password</label>
            <input class="input" type="password" name="confirmPassword" id="confirmPassword" required>
          </div>
          
          <button class="btn" type="submit" style="width:100%">Create Account</button>
        </form>

        <div style="text-align:center;font-size:14px" class="muted">
          <p>Already have an account? <a href="/login<%= next ? ('?next=' + encodeURIComponent(next)) : '' %>">Sign in</a></p>
        </div>
      </div>
    </div>
  </main>

  <%- include('./partials/footer') %>
</body>
</html>