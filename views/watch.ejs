<!DOCTYPE html>
<html lang="en">
<head>
  <%- include('./partials/head.ejs', { pageTitle: 'Educational Videos', pageDescription: 'Curated educational content' }) %>
</head>
<body>
  <%- include('./partials/navbar') %>
  <section class="hero">
    <div class="container">
      <a class="back" href="/" onclick="if(document.referrer){history.back();return false;}">‚Üê Back</a>
      <h2 style="margin:6px 0 2px 0">Educational Videos</h2>
      <div class="muted">Curated educational content from trusted sources.</div>
    </div>
  </section>

  <main class="container stack" style="--gap:20px">
    <% if (videos && videos.length) { %>
      <div class="grid cols-4">
        <% videos.forEach(v => { %>
          <div class="card hover">
            <% 
              const url = String(v.href || '');
              const yt = url.match(/(?:youtube\.com\/watch\?v=|youtu\.be\/)([\w-]+)/i);
              const vimeo = url.match(/vimeo\.com\/(\d+)/);
            %>

            <% if (yt) { %>
              <div style="position:relative;padding-top:56.25%;border-radius:12px;overflow:hidden">
                <iframe src="https://www.youtube.com/embed/<%= yt[1] %>" title="<%= v.title %>" frameborder="0"
                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                        allowfullscreen style="position:absolute;inset:0;width:100%;height:100%"></iframe>
              </div>
            <% } else if (vimeo) { %>
              <div style="position:relative;padding-top:56.25%;border-radius:12px;overflow:hidden">
                <iframe src="https://player.vimeo.com/video/<%= vimeo[1] %>" frameborder="0" allow="autoplay; fullscreen; picture-in-picture"
                        allowfullscreen style="position:absolute;inset:0;width:100%;height:100%"></iframe>
              </div>
            <% } else { %>
              <% if (v.thumbnail) { %>
                <img class="cover-img" src="<%= v.thumbnail %>" alt="">
              <% } else { %>
                <div class="cover-ph">VID</div>
              <% } %>
            <% } %>

            <div style="margin-top:10px">
              <div class="book-title"><%= v.title %></div>
              <div class="muted" style="font-size:12px;word-break:break-all"><%= v.href %></div>
            </div>

            <% if (!yt && !vimeo) { %>
              <a class="btn" style="margin-top:10px" href="<%= v.href %>" target="_blank" rel="noopener">Watch</a>
            <% } %>
          </div>
        <% }) %>
      </div>
    <% } else { %>
      <div class="card" style="text-align:center">No videos available yet.<br>Use the Admin panel to add some.</div>
    <% } %>
  </main>

  <%- include('./partials/footer') %>
